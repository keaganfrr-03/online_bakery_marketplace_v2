{% extends "base_vendor.html" %}
{% block title %}Reports{% endblock %}

{% block vendor_content %}
<h2>Reports</h2>

<form method="get" class="mb-3">
    <label for="period">Select Period:</label>
    <select name="period" id="period" class="form-select w-auto d-inline" onchange="this.form.submit()">
        <option value="all" {% if period == "all" %}selected{% endif %}>All Time</option>
        <option value="day" {% if period == "day" %}selected{% endif %}>Today</option>
        <option value="week" {% if period == "week" %}selected{% endif %}>This Week</option>
        <option value="month" {% if period == "month" %}selected{% endif %}>This Month</option>
    </select>
</form>

{% if sales %}
    <h4>
        Total Sales
        {% if period == "day" %}(Today){% endif %}
        {% if period == "week" %}(This Week){% endif %}
        {% if period == "month" %}(This Month){% endif %}
        {% if period == "all" %}(All Time){% endif %}
    </h4>
    <p><strong>R{{ total_sales }}</strong></p>

    <table class="table table-bordered table-striped mt-4">
        <thead>
            <tr>
                <th>Order #</th>
                <th>Product</th>
                <th>Quantity</th>
                <th>Price (Each)</th>
                <th>Subtotal</th>
                <th>Date</th>
            </tr>
        </thead>
        <tbody>
            {% for item in sales %}
            <tr>
                <td>{{ item.order.id }}</td>
                <td>{{ item.product.name }}</td>
                <td>{{ item.quantity }}</td>
                <td>R{{ item.price }}</td>
                <td>R{{ item.subtotal }}</td>
                <td>{{ item.order.created_at|date:"Y-m-d H:i" }}</td>
            </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <th colspan="4" class="text-end">Total ({{ period|title }})</th>
                <th colspan="2">R{{ total_sales }}</th>
            </tr>
        </tfoot>
    </table>
{% else %}
    <p class="text-muted">No sales found for this period.</p>
{% endif %}
{% endblock %}
